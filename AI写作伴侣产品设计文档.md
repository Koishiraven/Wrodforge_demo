# AI写作伴侣：从创意碎片到故事大纲 —— 产品设计文档 

 ## 1. 项目概述 
 **AI写作伴侣**是一个面向小说创作者的辅助工具，旨在帮助那些脑中有丰富故事创意却难以组织成文的新手作者。通过可视化的"侦探线索板"和"篮子+微调"的生成机制，让用户像玩游戏一样，将散落的角色、场景、设定卡片组合成情节片段，并最终梳理出完整的故事大纲。工具强调创作的乐趣和可控性，而非批量生成网文。 

 ## 2. 用户与痛点 
 ### 目标用户 
 - **核心用户**：有长期创作冲动、脑海里已构思大量点子（角色、场景、高光时刻）但从未完整写过小说的人。他们可能尝试过写作，但因缺乏结构感、无法组织碎片而放弃。 
 - **次要用户**：已有一定写作经验但希望更好梳理情节的网文作者或爱好者。 

 ### 核心痛点 
 - **想法太多却无从下手**：脑中有无数片段，但不知道如何串联成线。 
 - **现有工具门槛高**：AI聊天工具需要复杂提示词调教，且生成内容风格化不足；写作软件缺乏对碎片化创意的支持。 
 - **缺乏结构引导**：不了解故事应有的起承转合，面对空白文档容易迷茫。 
 - **情绪上的挫败感**：多次尝试失败后，自我怀疑，甚至放弃创作梦想。 

 ## 3. 价值主张 
 > **"帮那些脑子里已经有故事世界的人，把散落的创意碎片，自动编织成能写下去的大纲。"** 

 我们不替用户想故事，而是帮用户**整理**自己已有的想法，在关键节点提供AI启发，让创作过程变得轻松、有趣、有成就感。 

 ## 4. 核心功能设计 

 ### 4.1 线索板（中央画布） 
 - **无限画布**：用户可以自由放置卡片，缩放、拖拽。 
 - **卡片类型**： 
   - 角色卡：姓名、年龄、性格、目标、秘密等（可自定义字段） 
   - 事件卡：时间、地点、参与者、冲突等 
   - 设定卡：世界观、规则、物品等 
 - **卡片操作**：双击编辑内容，拖动调整位置，右下角缩放表示重要性（大=重要）。 
- **连线**：可选功能，用户可手动连接卡片表示关系（如"认识"、"导致"）（Demo 阶段不做）。 

 ### 4.2 时间参考线（画布引导） 
 - 画布上有一条贯穿左右的**水平参考线**，左侧代表"过去"，右侧代表"未来"。 
 - 用户可本能地将卡片按时间顺序放置（过去的放左边，未来的放右边）。 
 - 支持多时间线（如多条平行时间线）和闪回标记，但默认一条线降低复杂度。 

 ### 4.3 底部篮子（工作区） 
 - 固定在画布下方，占屏幕约1/4高度，像一个"购物篮"。 
- 用户可将画布上的卡片加入篮子（拖拽或点击加入），卡片缩略图水平排列（Demo 主路径为点击加入）。 
 - 篮子内卡片可移除，最多容纳5张（避免信息过载）。 
 - 篮子状态实时反映在右侧微调面板。 

 ### 4.4 右侧微调面板 
 - **卡片摘要**：显示当前篮子中卡片的类型和标题。 
 - **AI自动填充字段**： 
   - 时间（如"白天"、"黄昏"，可编辑下拉） 
   - 地点（自动提取，可编辑） 
   - 人物（列出角色及其属性，可修改） 
   - 冲突/目标（AI根据卡片内容建议，可编辑） 
 - **微调输入框**：用户用一句话描述想要的感觉（如"让相遇尴尬一点"），placeholder提供示例，下方有常用短语按钮（温馨、搞笑、紧张等）。 
 - **生成按钮**：点击后AI基于字段和微调生成情节。 

 ### 4.5 生成与放回流程 
 1. 用户点击生成，AI返回一段200-300字的情节文本。 
 2. 右侧面板显示生成结果预览，并提供选项： 
    - **重新生成**（同一组输入） 
    - **修改后生成**（返回字段编辑） 
    - **采纳并放回画布**：生成的情节变为一张新卡片，出现在画布中央，用户可自行拖入时间轴。 
    - **采纳并放入时间轴**：AI推测时间点，新卡片半透明出现在参考线相应位置，用户拖拽确认后固定。 
 3. 用户可清空篮子，开始新的组合。 

 ## 5. 交互流程示例 
 **用户"小明"的创作过程**： 
 - 小明在画布上已有卡片："李风"（15岁孤儿，倔强）、"望月宗"（修仙门派）、"小瑶"（16岁师妹，活泼）。 
 - 他想写"李风初入望月宗遇到小瑶"的情节。 
- 小明依次将三张卡片加入底部篮子（拖拽或点击加入）。篮子显示三个缩略图。 
 - 右侧面板自动填充：时间=白天（可改黄昏），地点=望月宗，人物列出李风、小瑶属性，冲突建议="小瑶误会李风是闯入者"。 
 - 小明将时间改为"黄昏"，在微调框输入"小瑶故意捉弄李风，但李风一本正经"，点击生成。 
 - 几秒后，右侧显示生成的情节预览。小明满意，点击"采纳并放入时间轴"。 
 - 新卡片半透明出现在时间参考线上"过去"区域（因为"拜师"卡片在未来），小明拖动到合适位置，卡片变为实体。 
 - 新卡片上写着"初遇小瑶（黄昏，望月宗山门台阶）"，点击可展开完整文本。 

 ## 6. MVP建议 
 为快速验证核心假设，MVP应包含以下最小功能集： 
1. **画布**：支持放置卡片（多类型）、拖拽、缩放（可用现有开源库如tldraw或fabric.js快速搭建）。 
 2. **时间参考线**：静态参考线，无自动对齐。 
 3. **底部篮子**：支持点击加入，拖入可选增强；显示缩略图，支持移除。 
 4. **右侧微调面板**： 
    - 简单字段：时间、地点（固定文本框，无AI自动填充，初期用户手动填写）。 
    - 微调输入框（带常用短语按钮）。 
    - 生成按钮（调用AI API）。 
 5. **生成结果处理**：生成后显示文本，提供"放回画布"按钮（新卡片出现在画布中央，带生成文本）。 
6. **卡片类型**：保留角色/事件/设定/情节四类，字段极简但区分清晰。 

 **技术实现**： 
 - 前端：React/Vue + 画布库，直接调用OpenAI API（demo阶段可暴露API密钥，或使用短期密钥）。 
 - 后端（可选）：初期可用云函数代理API调用，保护密钥。 

 **验证目标**： 
 - 用户是否理解"拖卡片到篮子→微调→生成"的流程？ 
 - 生成的情节是否让用户感到"这是我的想法被理解了"？ 
 - 用户是否愿意继续使用，并尝试生成更多情节？ 

 ## 7. 潜在问题与应对 
 | 问题 | 应对方案 | 
 |------|----------| 
 | 卡片信息不足，AI生成空洞 | MVP阶段用户手动填写字段；后续引入卡片模板，鼓励填写关键属性。 | 
 | 新手对微调输入框有压力 | 提供常用短语按钮；placeholder示例；允许留空。 | 
 | 篮子卡片过多导致生成混乱 | 限制最多5张，提示移除。 | 
 | 时间推测不准 | MVP采用手动放置（放回画布），后续引入迷你时间轴滑块。 | 
 | 与其他工具（如Obsidian）相似 | 强调"篮子+微调"的生成闭环和AI辅助，而非纯笔记。 | 

 ## 8. 未来扩展方向 
 - **卡片模板**：角色、事件、设定等预设字段，提升AI理解。 
 - **自动连线**：根据语义推荐卡片关系。 
 - **多篮子**：同时构思多个情节。 
 - **协作与分享**：分享篮子组合，社区共创。 
 - **导出功能**：一键生成故事大纲/章节草稿。 
 - **学习用户偏好**：记住常用修改，提升AI准确度。 

 --- 

 本设计聚焦于让创作过程**可视化、可组合、可微调**，让AI成为用户的灵感伙伴而非替代者。下一步建议制作可交互原型，招募种子用户测试核心流程，根据反馈快速迭代。

## 9. 一天 Demo 实施方案（前端验证）

### 9.1 默认假设
- 目标是验证核心交互闭环：卡片（多类型）→ 加入篮子 → 微调 → 生成情节卡 → 放回画布与时间参考线
- 只做 PC Web 前端 Demo，后端不是重点；允许使用本地数据与 Mock 兜底
- 不实现自动连线与关系网络；保留画布拖拽、缩放、选择等基础操作
- 优先级：互动逻辑成立 > 能稳定生成情节卡 > 视觉美观

### 9.2 本次交付产物清单（一天内）
- 一个可运行的前端页面原型：中央画布 + 底部篮子 + 右侧面板 + 顶部工具条
- 支持多卡片类型：角色卡 / 事件卡 / 设定卡 / 情节卡（生成结果）
- 支持基础编辑：选中卡片后在右侧面板编辑字段与正文
- 支持篮子组合：加入/移除/上限提示（默认 5 张）
- 支持生成闭环：生成情节预览、重新生成、采纳并生成情节卡（放回画布）
- 支持最小“时间参考线”引导：画布中线展示过去/未来方向，并为卡片显示“左/右侧”标签

### 9.3 信息架构与页面布局
- 顶部工具条
  - 新建卡片（选择类型）
  - 新建空白画布（清空并重置到示例数据）
  - 生成按钮（当篮子满足条件）
  - 状态：生成中 / 可生成 / 生成失败
- 中央画布（线索板）
  - 无限画布、缩放、拖拽移动
  - 卡片以不同颜色/徽标区分类型
  - 无连线功能入口（不显示连接点、不提供连线交互）
- 底部篮子（工作区）
  - 横向缩略条：显示已选卡片（类型 + 标题）
  - 支持一键移除、清空、上限提示
- 右侧面板（编辑与生成）
  - 选中卡片：显示该卡片字段编辑区
  - 篮子视图：显示篮子卡片摘要与微调输入区
  - 生成结果：展示情节预览与操作按钮（重新生成 / 采纳并放回画布）

### 9.4 交互流程（用户如何完成一次生成）
1. 用户在画布上查看多类型卡片（预置示例：角色 2 张、设定 1 张、事件 1 张）
2. 用户将若干张卡片加入篮子
   - 主路径：点击卡片上的“加入篮子”按钮或在右侧面板点击“加入篮子”
   - 规则：最多 5 张；超过时给出明确提示并阻止继续加入
3. 用户在右侧面板输入微调（可为空）
4. 用户点击“生成情节”
   - UI 进入生成中：禁用再次点击、展示加载反馈
5. 生成成功后右侧展示“情节预览”
   - 允许重新生成（沿用同一篮子与微调）
   - 允许采纳：将预览变为“情节卡”，插入画布中央
6. 用户拖动情节卡到时间参考线附近，自行决定放置位置（过去/未来）

### 9.5 组件拆分与状态模型（前端 Demo 级）

#### 组件拆分
- AppShell：整体布局（顶部/画布/篮子/右侧面板）
- CanvasBoard：画布容器（节点渲染、缩放、拖拽、选择）
- CardNode：卡片节点 UI（标题、类型徽标、摘要、加入篮子按钮）
- BasketBar：篮子缩略条（上限提示、清空、移除）
- SidePanel：右侧面板（Tab 或条件渲染：卡片编辑 / 生成面板 / 结果预览）
- GeneratePanel：微调输入、生成按钮、生成状态
- GenerateResult：预览、重新生成、采纳按钮

#### 状态模型（建议）
- Canvas
  - cards：所有卡片（含位置与类型）
  - selectedCardId：当前选中卡片
  - viewport：缩放与平移（可由画布库内部管理）
- Basket
  - basketCardIds：篮子中卡片 id 列表（有序）
  - basketLimit：默认 5
- Generate
  - mode：idle | generating | success | error
  - promptDraft：微调文本
  - lastRequest：最近一次生成输入快照（用于重试）
  - resultDraft：生成结果（结构化字段与原文）
  - errorMessage：错误信息（展示给用户）

### 9.6 多卡片类型定义（Demo 级字段）

#### 角色卡（Role）
- title：角色名
- age：年龄（可空）
- traits：性格标签（若干短词，可空）
- goal：目标（可空）
- secret：秘密（可空）
- notes：自由文本

#### 事件卡（Event）
- title：事件名
- time：时间描述（可空）
- place：地点（可空）
- participants：参与者（引用角色名或自由文本）
- conflict：冲突（可空）
- notes：自由文本

#### 设定卡（Setting）
- title：设定名
- domain：领域（世界观/规则/物品/组织…）
- rule：规则/限制（可空）
- keyword：关键词（可空）
- notes：自由文本

#### 情节卡（Plot，生成结果）
- title：情节标题（生成或可编辑）
- timeHint：建议时间（可空）
- placeHint：建议地点（可空）
- summary：一句话摘要（可空）
- content：200–300 字情节正文
- sourceCardIds：来自哪个篮子组合（用于回溯）

### 9.7 生成接口契约（前端优先 + 兜底策略）

#### 输入（前端拼装）
- basketCards：按类型结构化摘要（不是简单拼接）
- instruction：用户微调文本（可空）
- constraints
  - 字数：200–300 字
  - 风格：贴合卡片信息，不新增重大设定（除非设定卡允许）
  - 输出格式：优先结构化 JSON

#### 输出（建议格式）
- 成功时返回对象（JSON）
  - title：字符串
  - timeHint：字符串（可空）
  - placeHint：字符串（可空）
  - summary：字符串（可空）
  - content：字符串（必填）
- 失败时返回错误
  - code：NETWORK | TIMEOUT | PROVIDER | FORMAT
  - message：可展示的短文案

#### 兜底策略（保证 Demo 可演示）
- 真实调用不可用时（Key/CORS/断网/超时），自动回退到 Mock 生成器
  - Mock 生成器基于篮子卡片字段拼装固定模板，并做少量随机化
  - UI 明确标注“已使用本地生成（演示模式）”，避免误导

### 9.8 一天工期拆分（8 小时节奏）
- 09:00–10:30：项目骨架与布局（顶部/画布/篮子/右侧面板）
- 10:30–12:00：多卡片类型与卡片编辑（右侧面板编辑选中卡片）
- 13:00–14:30：篮子逻辑（加入/移除/上限提示/清空/摘要展示）
- 14:30–16:00：生成闭环（输入快照、生成状态、预览、重新生成、采纳生成情节卡）
- 16:00–17:00：时间参考线与“过去/未来”最小标记规则
- 17:00–18:00：视觉统一与演示数据打磨（间距、字体、阴影、状态反馈）

### 9.9 验收标准（可演示、可复现）
- 打开页面即有示例卡片（至少 4 张：角色 2、设定 1、事件 1）
- 能在画布上拖拽、缩放、选中卡片
- 能创建不同类型卡片，并在右侧面板编辑字段
- 能把卡片加入篮子，篮子上限生效且提示清晰
- 点击生成后能得到情节预览，并能采纳生成“情节卡”回到画布
- 生成失败时有明确错误态，并可重试；断网也能通过 Mock 兜底完成闭环

### 9.10 主要风险与规避（面向一天交付）
- 输入编辑与画布拖拽冲突：不在节点内直接编辑，统一在右侧面板编辑
- 跨容器拖拽复杂：篮子主路径采用点击加入，拖拽仅作为可选增强
- 模型调用不稳定：真实调用 + Mock 兜底双通道，确保任何环境可演示
